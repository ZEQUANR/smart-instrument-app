{"version":3,"file":"types.js","sources":["uni_modules/wot-design-uni/components/wd-form/types.ts"],"sourcesContent":["/*\n * @Author: weisheng\n * @Date: 2023-12-14 11:21:58\n * @LastEditTime: 2025-01-11 13:31:20\n * @LastEditors: weisheng\n * @Description:\n * @FilePath: /wot-design-uni/src/uni_modules/wot-design-uni/components/wd-form/types.ts\n * 记得注释\n */\nimport { type ComponentPublicInstance, type ExtractPropTypes, type InjectionKey, type PropType } from 'vue'\nimport { baseProps, makeBooleanProp, makeRequiredProp } from '../common/props'\n\nexport type FormProvide = {\n  props: {\n    model: Record<string, any>\n    rules?: FormRules\n    border?: boolean\n  }\n  errorMessages?: Record<string, string>\n}\n\nexport const FORM_KEY: InjectionKey<FormProvide> = Symbol('wd-form')\n\nexport type FormRules = {\n  [key: string]: FormItemRule[]\n}\n\nexport type ErrorMessage = {\n  prop: string\n  message: string\n}\n\nexport interface FormItemRule {\n  [key: string]: any\n  required: boolean\n  message: string\n  pattern?: RegExp\n  validator?: (value: any, rule: FormItemRuleWithoutValidator) => boolean | Promise<string> | Promise<boolean> | Promise<void> | Promise<unknown>\n}\n\nexport type FormItemRuleWithoutValidator = Omit<FormItemRule, 'validator'>\n\nexport const formProps = {\n  ...baseProps,\n  /**\n   * 表单数据对象\n   */\n  model: makeRequiredProp(Object as PropType<Record<string, any>>),\n  /**\n   * 表单验证规则\n   */\n  rules: {\n    type: Object as PropType<FormRules>,\n    default: () => ({})\n  },\n  /**\n   * 是否在输入时重置表单校验信息\n   */\n  resetOnChange: makeBooleanProp(true),\n  /**\n   * 错误提示类型\n   */\n  errorType: {\n    type: String as PropType<'toast' | 'message' | 'none'>,\n    default: 'message'\n  }\n}\nexport type FormProps = ExtractPropTypes<typeof formProps>\n\nexport type FormExpose = {\n  /**\n   * 表单校验\n   * @param prop 指定校验字段\n   */\n  validate: (prop?: string | Array<string>) => Promise<{\n    valid: boolean\n    errors: ErrorMessage[]\n  }>\n  /**\n   * 重置表单项的验证提示\n   */\n  reset: () => void\n}\n\nexport type FormInstance = ComponentPublicInstance<FormProps, FormExpose>\n"],"names":["baseProps","makeRequiredProp","makeBooleanProp"],"mappings":";;AAqBa,MAAA,WAAsC,OAAO,SAAS;AAAA,CAqB1C;AAAA,EACvB,GAAGA,iDAAA;AAAA;AAAA;AAAA;AAAA,EAIH,OAAOC,kEAAiB,MAAuC;AAAA;AAAA;AAAA;AAAA,EAI/D,OAAO;AAAA,IACL,MAAM;AAAA,IACN,SAAS,OAAO,CAAA;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA,EAIA,eAAeC,iEAAgB,IAAI;AAAA;AAAA;AAAA;AAAA,EAInC,WAAW;AAAA,IACT,MAAM;AAAA,IACN,SAAS;AAAA,EACX;AACF;;"}