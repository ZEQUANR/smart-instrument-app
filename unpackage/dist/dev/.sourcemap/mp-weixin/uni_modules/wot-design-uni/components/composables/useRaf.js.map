{"version":3,"file":"useRaf.js","sources":["uni_modules/wot-design-uni/components/composables/useRaf.ts"],"sourcesContent":["import { ref, onUnmounted } from 'vue'\nimport { isDef, isH5, isNumber } from '../common/util'\n\n// 定义回调函数类型\ntype RafCallback = (time: number) => void\n\nexport function useRaf(callback: RafCallback) {\n  const requestRef = ref<number | null | ReturnType<typeof setTimeout>>(null)\n\n  // 启动动画帧\n  const start = () => {\n    const handle = (time: number) => {\n      callback(time)\n    }\n\n    if (isH5) {\n      requestRef.value = requestAnimationFrame(handle)\n    } else {\n      requestRef.value = setTimeout(() => handle(Date.now()), 1000 / 30)\n    }\n  }\n\n  // 取消动画帧\n  const cancel = () => {\n    if (isH5 && isNumber(requestRef.value)) {\n      cancelAnimationFrame(requestRef.value!)\n    } else if (isDef(requestRef.value)) {\n      clearTimeout(requestRef.value)\n    }\n  }\n\n  onUnmounted(() => {\n    cancel()\n  })\n\n  return { start, cancel }\n}\n"],"names":["ref","isH5","isNumber","isDef","onUnmounted"],"mappings":";;;AAMO,SAAS,OAAO,UAAuB;AACtC,QAAA,aAAaA,kBAAmD,IAAI;AAG1E,QAAM,QAAQ,MAAM;AACZ,UAAA,SAAS,CAAC,SAAiB;AAC/B,eAAS,IAAI;AAAA,IAAA;AAGf,QAAIC,sDAAM;AACG,iBAAA,QAAQ,sBAAsB,MAAM;AAAA,IAAA,OAC1C;AACM,iBAAA,QAAQ,WAAW,MAAM,OAAO,KAAK,KAAK,GAAG,MAAO,EAAE;AAAA,IACnE;AAAA,EAAA;AAIF,QAAM,SAAS,MAAM;AACnB,QAAIA,wDAAQC,gDAAAA,SAAS,WAAW,KAAK,GAAG;AACtC,2BAAqB,WAAW,KAAM;AAAA,IAC7B,WAAAC,gDAAA,MAAM,WAAW,KAAK,GAAG;AAClC,mBAAa,WAAW,KAAK;AAAA,IAC/B;AAAA,EAAA;AAGFC,gBAAAA,YAAY,MAAM;AACT;EAAA,CACR;AAEM,SAAA,EAAE,OAAO;AAClB;;"}