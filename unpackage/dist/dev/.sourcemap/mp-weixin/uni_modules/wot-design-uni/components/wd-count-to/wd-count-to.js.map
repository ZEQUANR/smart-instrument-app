{"version":3,"file":"wd-count-to.js","sources":["uni_modules/wot-design-uni/components/wd-count-to/wd-count-to.vue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovbGVhcm4vSEJ1aWxkZXJQcm9qZWN0cy9zbWFydC1pbnN0cnVtZW50LWFwcC91bmlfbW9kdWxlcy93b3QtZGVzaWduLXVuaS9jb21wb25lbnRzL3dkLWNvdW50LXRvL3dkLWNvdW50LXRvLnZ1ZQ"],"sourcesContent":["<template>\n  <view :class=\"rootClass\">\n    <!-- 前缀插槽 -->\n    <slot name=\"prefix\">\n      <wd-text :type=\"props.type\" :color=\"props.color\" :size=\"`${props.fontSize * 0.7}px`\" :text=\"props.prefix\"></wd-text>\n    </slot>\n    <!-- 默认文本插槽 -->\n    <slot>\n      <wd-text :type=\"props.type\" :color=\"props.color\" :size=\"`${props.fontSize}px`\" :text=\"timeText\"></wd-text>\n    </slot>\n    <!-- 后缀插槽 -->\n    <slot name=\"suffix\">\n      <wd-text :type=\"props.type\" :color=\"props.color\" :size=\"`${props.fontSize * 0.7}px`\" :text=\"props.suffix\"></wd-text>\n    </slot>\n  </view>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  name: 'wd-count-to',\n  options: {\n    virtualHost: true,\n    addGlobalClass: true,\n    styleIsolation: 'shared'\n  }\n}\n</script>\n\n<script lang=\"ts\" setup>\nimport wdText from '../wd-text/wd-text.vue'\nimport { computed, watch, onMounted } from 'vue'\nimport { countToProps } from './types'\nimport { easingFn, isNumber } from '../common/util'\nimport { useCountDown } from '../composables/useCountDown'\nimport type { CountDownExpose } from '../wd-count-down/types'\n\nconst props = defineProps(countToProps)\nconst emit = defineEmits(['mounted', 'finish'])\n\nconst { start, pause, reset, current } = useCountDown({\n  time: props.duration,\n  millisecond: true,\n  onFinish: () => emit('finish')\n})\n\n// 计算根元素的类名\nconst rootClass = computed(() => {\n  return `wd-count-to ${props.customClass}`\n})\n\nconst timeText = computed(() => {\n  return parseFormat(current.value.total)\n})\n\nwatch([() => props.startVal, () => props.endVal, () => props.duration], resetTime, { immediate: false })\n\nonMounted(() => {\n  resetTime()\n  emit('mounted')\n})\n\n// 重置动画\nfunction resetTime() {\n  reset(props.duration)\n  if (props.autoStart) {\n    start()\n  }\n}\n\nfunction parseFormat(remain: number) {\n  const { startVal, endVal, duration, useEasing } = props\n  const progress = duration - remain // 已经进行的时间\n  const isPositive = startVal > endVal // 判断startVal是否大于endVal\n  const progressRatio = progress / duration // 计算进度比例\n\n  let currentVal: number\n\n  if (useEasing) {\n    // 使用缓动函数计算currentVal\n    if (isPositive) {\n      currentVal = startVal - easingFn(progress, 0, startVal - endVal, duration) || 0\n    } else {\n      currentVal = easingFn(progress, startVal, endVal - startVal, duration)\n    }\n  } else {\n    // 不使用缓动函数时的计算方式\n    if (isPositive) {\n      currentVal = startVal - (startVal - endVal) * progressRatio\n    } else {\n      currentVal = startVal + (endVal - startVal) * progressRatio\n    }\n  }\n  // 确保currentVal在startVal和endVal之间\n  currentVal = isPositive ? Math.max(endVal, currentVal) : Math.min(endVal, currentVal)\n  return formatNumber(currentVal)\n}\n\n// 格式化数字\nfunction formatNumber(num: any): string {\n  if (typeof num !== 'number') {\n    num = parseFloat(num)\n    if (isNaN(num)) {\n      return '0'\n    }\n  }\n  num = num.toFixed(props.decimals)\n  const parts = num.split('.')\n  let integerPart = parts[0]\n  const decimalPart = parts.length > 1 ? props.decimal + parts[1] : ''\n  const rgx = /(\\d+)(\\d{3})/\n\n  if (props.separator && !isNumber(props.separator)) {\n    while (rgx.test(integerPart)) {\n      integerPart = integerPart.replace(rgx, '$1' + props.separator + '$2')\n    }\n  }\n  return integerPart + decimalPart\n}\n\ndefineExpose<CountDownExpose>({ start, reset: resetTime, pause })\n</script>\n\n<style lang=\"scss\" scoped>\n@import './index.scss';\n</style>\n","import Component from 'D:/learn/HBuilderProjects/smart-instrument-app/uni_modules/wot-design-uni/components/wd-count-to/wd-count-to.vue'\nwx.createComponent(Component)"],"names":["useCountDown","computed","watch","onMounted","easingFn","isNumber"],"mappings":";;;;;;;;AA6BA,MAAA,SAAmB,MAAA;AAXnB,MAAA,cAAe;AAAA,EACb,MAAM;AAAA,EACN,SAAS;AAAA,IACP,aAAa;AAAA,IACb,gBAAgB;AAAA,IAChB,gBAAgB;AAAA,EAClB;AACF;;;;;;AAWA,UAAM,QAAQ;AACd,UAAM,OAAO;AAEb,UAAM,EAAE,OAAO,OAAO,OAAO,QAAA,IAAYA,6DAAAA,aAAa;AAAA,MACpD,MAAM,MAAM;AAAA,MACZ,aAAa;AAAA,MACb,UAAU,MAAM,KAAK,QAAQ;AAAA,IAAA,CAC9B;AAGK,UAAA,YAAYC,cAAAA,SAAS,MAAM;AACxB,aAAA,eAAe,MAAM,WAAW;AAAA,IAAA,CACxC;AAEK,UAAA,WAAWA,cAAAA,SAAS,MAAM;AACvB,aAAA,YAAY,QAAQ,MAAM,KAAK;AAAA,IAAA,CACvC;AAEDC,kBAAAA,MAAM,CAAC,MAAM,MAAM,UAAU,MAAM,MAAM,QAAQ,MAAM,MAAM,QAAQ,GAAG,WAAW,EAAE,WAAW,MAAO,CAAA;AAEvGC,kBAAAA,UAAU,MAAM;AACJ;AACV,WAAK,SAAS;AAAA,IAAA,CACf;AAGD,aAAS,YAAY;AACnB,YAAM,MAAM,QAAQ;AACpB,UAAI,MAAM,WAAW;AACb;MACR;AAAA,IACF;AAEA,aAAS,YAAY,QAAgB;AACnC,YAAM,EAAE,UAAU,QAAQ,UAAU,cAAc;AAClD,YAAM,WAAW,WAAW;AAC5B,YAAM,aAAa,WAAW;AAC9B,YAAM,gBAAgB,WAAW;AAE7B,UAAA;AAEJ,UAAI,WAAW;AAEb,YAAI,YAAY;AACd,uBAAa,WAAWC,gDAAS,SAAA,UAAU,GAAG,WAAW,QAAQ,QAAQ,KAAK;AAAA,QAAA,OACzE;AACL,uBAAaA,gDAAS,SAAA,UAAU,UAAU,SAAS,UAAU,QAAQ;AAAA,QACvE;AAAA,MAAA,OACK;AAEL,YAAI,YAAY;AACD,uBAAA,YAAY,WAAW,UAAU;AAAA,QAAA,OACzC;AACQ,uBAAA,YAAY,SAAS,YAAY;AAAA,QAChD;AAAA,MACF;AAEa,mBAAA,aAAa,KAAK,IAAI,QAAQ,UAAU,IAAI,KAAK,IAAI,QAAQ,UAAU;AACpF,aAAO,aAAa,UAAU;AAAA,IAChC;AAGA,aAAS,aAAa,KAAkB;AAClC,UAAA,OAAO,QAAQ,UAAU;AAC3B,cAAM,WAAW,GAAG;AAChB,YAAA,MAAM,GAAG,GAAG;AACP,iBAAA;AAAA,QACT;AAAA,MACF;AACM,YAAA,IAAI,QAAQ,MAAM,QAAQ;AAC1B,YAAA,QAAQ,IAAI,MAAM,GAAG;AACvB,UAAA,cAAc,MAAM,CAAC;AACnB,YAAA,cAAc,MAAM,SAAS,IAAI,MAAM,UAAU,MAAM,CAAC,IAAI;AAClE,YAAM,MAAM;AAEZ,UAAI,MAAM,aAAa,CAACC,gDAAS,SAAA,MAAM,SAAS,GAAG;AAC1C,eAAA,IAAI,KAAK,WAAW,GAAG;AAC5B,wBAAc,YAAY,QAAQ,KAAK,OAAO,MAAM,YAAY,IAAI;AAAA,QACtE;AAAA,MACF;AACA,aAAO,cAAc;AAAA,IACvB;AAEA,aAA8B,EAAE,OAAO,OAAO,WAAW,MAAO,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtHhE,GAAG,gBAAgB,SAAS;"}