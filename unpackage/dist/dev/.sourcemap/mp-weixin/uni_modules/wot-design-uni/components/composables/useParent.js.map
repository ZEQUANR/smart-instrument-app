{"version":3,"file":"useParent.js","sources":["uni_modules/wot-design-uni/components/composables/useParent.ts"],"sourcesContent":["import {\n  ref,\n  inject,\n  computed,\n  onUnmounted,\n  type InjectionKey,\n  getCurrentInstance,\n  type ComponentPublicInstance,\n  type ComponentInternalInstance\n} from 'vue'\n\ntype ParentProvide<T> = T & {\n  link(child: ComponentInternalInstance): void\n  unlink(child: ComponentInternalInstance): void\n  children: ComponentPublicInstance[]\n  internalChildren: ComponentInternalInstance[]\n}\n\nexport function useParent<T>(key: InjectionKey<ParentProvide<T>>) {\n  const parent = inject(key, null)\n\n  if (parent) {\n    const instance = getCurrentInstance()!\n    const { link, unlink, internalChildren } = parent\n\n    link(instance)\n    onUnmounted(() => unlink(instance))\n\n    const index = computed(() => internalChildren.indexOf(instance))\n\n    return {\n      parent,\n      index\n    }\n  }\n\n  return {\n    parent: null,\n    index: ref(-1)\n  }\n}\n"],"names":["inject","getCurrentInstance","onUnmounted","computed","ref"],"mappings":";;AAkBO,SAAS,UAAa,KAAqC;AAC1D,QAAA,SAASA,cAAAA,OAAO,KAAK,IAAI;AAE/B,MAAI,QAAQ;AACV,UAAM,WAAWC,cAAAA;AACjB,UAAM,EAAE,MAAM,QAAQ,iBAAA,IAAqB;AAE3C,SAAK,QAAQ;AACDC,kBAAAA,YAAA,MAAM,OAAO,QAAQ,CAAC;AAElC,UAAM,QAAQC,cAAAA,SAAS,MAAM,iBAAiB,QAAQ,QAAQ,CAAC;AAExD,WAAA;AAAA,MACL;AAAA,MACA;AAAA,IAAA;AAAA,EAEJ;AAEO,SAAA;AAAA,IACL,QAAQ;AAAA,IACR,OAAOC,cAAAA,IAAI,EAAE;AAAA,EAAA;AAEjB;;"}